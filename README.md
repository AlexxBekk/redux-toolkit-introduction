# **Задание: Управление измерениями и генерация отчёта с помощью Redux Toolkit**

## **Описание**
Ты создашь приложение, в котором:
1. Пользователь вводит паспортные данные измерения через модальное окно.
2. Выбирает прибор для проведения измерений из списка, загруженного с сервера (мока).
3. Нажимает кнопку "Начать измерение", которая генерирует случайные данные измерений.
4. Формирует отчёт, отображающий паспортные данные, выбранный прибор и результаты измерения.

---

## **Цели задания**
1. Научиться создавать и настраивать хранилище с помощью Redux Toolkit.
2. Освоить написание экшенов, селекторов и диспатчей для управления состоянием.
3. Применять Redux Toolkit для предоставления данных в разнесённые компоненты.
4. Научиться работать с несколькими срезами (slices) состояния.
5. Имитировать загрузку данных с сервера и занести их в состояние.
6. Управлять состоянием модальных окон и интеграцией их с глобальным хранилищем.
7. Освоить написание селекторов для упрощения доступа к данным в состоянии.
8. Реализовать отображение итогового отчёта.

## **Что стоит прочитать перед началом**
     
1. [**Redux Toolkit — быстрое начало**](https://redux-toolkit.js.org/tutorials/quick-start)  
   - Пошаговое руководство для быстрого знакомства Redux Toolkit.
   
2. [**Документация по Redux Toolkit slices**](https://redux-toolkit.js.org/api/createslice)  
   - Как создавать и использовать срезы состояния.

3. [**React.useSelector — документация**](https://react-redux.js.org/api/hooks#useselector)  
   - Для доступа к состоянию Redux из компонентов.

4. [**React.useDispatch — документация**](https://react-redux.js.org/api/hooks#usedispatch)  
   - Для отправки экшенов в Redux.

5. [**Документация по Immer**](https://immerjs.github.io/immer/)  
   - Как работает иммутабельность под капотом Redux Toolkit. 
---

## **Задачи**

### **1. Создай срезы (slices) состояния:**
#### **1.1. `passportSlice`:**
- **Отвечает за паспортные данные измерения.**
- **Поля состояния:**
  - `name`: название измерения.
  - `date`: дата измерения.
  - `operator`: оператор измерения.
- **Экшены:**
  - `setPassportData(payload)`: записывает данные.

#### **1.2. `deviceSlice`:**
- **Отвечает за список приборов и выбор текущего прибора.**
- **Поля состояния:**
  - `devices`: массив доступных приборов.
  - `selectedDevice`: выбранный прибор.
- **Экшены:**
  - `setDevices(payload)`: сохраняет список приборов.
  - `selectDevice(payload)`: сохраняет выбранный прибор.

#### **1.3. `resultsSlice`:**
- **Отвечает за результаты измерений.**
- **Поля состояния:**
  - `results`: массив случайных чисел.
  - `usedDevice`: выбранный прибор.
- **Экшены:**
  - `addResults(payload)`: сохраняет массив результатов и выбранный прибор.
  - `clearResults()`: очищает результаты.

---

### **2. Реализуй селекторы:**
Создай селекторы для упрощения доступа к состоянию:
- `selectPassport`: возвращает паспортные данные (`name`, `date`, `operator`) из `passportSlice`.
- `selectDevices`: возвращает список доступных приборов из `deviceSlice`.
- `selectSelectedDevice`: возвращает выбранный прибор из `deviceSlice`.
- `selectResults`: возвращает массив результатов измерений из `resultsSlice`.
- `selectUsedDevice`: возвращает прибор, на котором проводились измерения из `resultsSlice`.

---

### **3. Реализуй интерфейс:**

#### **Модальное окно 1: Паспортные данные**
- **Поля:**
  - Название измерения.
  - Дата.
  - Оператор.
- **Кнопка "Сохранить":**
  - Сохраняет данные в `passportSlice`.
- **Кнопка "Отмена":**
  - Закрывает окно без сохранения.

#### **Модальное окно 2: Выбор прибора**
- Отображает список приборов, загруженных из мок-API.
- Радиокнопки для выбора одного прибора.
- **Кнопка "Сохранить":**
  - Сохраняет выбранный прибор в `deviceSlice`.

#### **Основной экран**
- **Кнопка "Начать измерение":**
  - Генерирует 10 случайных чисел.
  - Сохраняет результаты измерения и выбранный прибор в `resultsSlice`.
- **Кнопка "Сформировать отчёт":**
  - Отображает:
    - Паспортные данные.
    - Выбранный прибор.
    - Результаты измерения.

---

## **Подсказки**
1. **Иммутабельность:**  
   В прошлом задании мы тренировались делать изменения иммутабельно, но Redux Toolkit имеет под капотом **Immer**, что позволяет писать код так, как будто ты мутируешь исходный объект, сохраняя иммутабельность. Это работает, потому что наш код становится "драфтом" (наброском) того, как должно измениться состояние, а библиотека сама производит изменения иммутабельным образом.

### Пример использования Immer в Redux Toolkit:

#### Без Immer:
```javascript
function updateItemQuantity(state, action) {
  return state.map((item) => {
    if (item.id === action.payload.id) {
      return {
        ...item,
        quantity: item.quantity + action.payload.amount,
      };
    }
    return item;
  });
}
```

#### С Immer (в Redux Toolkit):
```javascript
import { createSlice } from '@reduxjs/toolkit';

const cartSlice = createSlice({
  name: 'cart',
  initialState: [],
  reducers: {
    updateItemQuantity(state, action) {
      const item = state.find((item) => item.id === action.payload.id);
      if (item) {
        item.quantity += action.payload.amount; // Пишем код, будто мутируем объект
      }
    },
  },
});

export const { updateItemQuantity } = cartSlice.actions;
export default cartSlice.reducer;
```

2. **Селекторы:**  
   Селекторы помогают упростить доступ к данным и делают код более читаемым. Например:
   ```javascript
   const passportData = useSelector(selectPassport);
   const devices = useSelector(selectDevices);
   ```
3. **Что такое мок?**  
Мок (mock) — это имитация работы сервера или внешнего источника данных. Вместо реального взаимодействия с сервером, ты создаёшь фиктивные данные, которые загружаются в приложение. Это упрощает тестирование и разработку.
